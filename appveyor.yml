version: '{build}-{branch}'
image: Visual Studio 2017
platform:
  - x64
# Maximum number of concurrent jobs for the project
max_jobs: 1
init:
- ps: |
    [Net.ServicePointManager]::SecurityProtocol = 'Ssl3, Tls, Tls11, Tls12'
    choco install virtualbox
    choco install vagrant
    cd $env:APPVEYOR_BUILD_FOLDER
- ps: |
    While ((Test-NetConnection google.com -Port 80 -InformationLevel Quiet) -ne "True") {
        echo "waiting for network..."
        Start-Sleep 1
    }
- ps: |
    mkdir %userprofile%\.vagrant.d | Out-Null
    echo @'
    Vagrant::configure('2') do |config|
      config.vm.boot_timeout = 2048
    end
    '@ | Out-File -encoding UTF8 %userprofile%\.vagrant.d\Vagrantfile
install:
- refreshenv
- vagrant -v
- VBoxManage -v
- ssh -V
- ipconfig /all
build_script:
- ps: Test-NetConnection google.com -Port 80
- vagrant up
- vagrant ssh -c "uname -a"

# Disable automatic builds
build: off

after_build:
- echo "Finished building playground"

test: off
